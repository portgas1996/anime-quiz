```html
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>–í–∏–∫—Ç–æ—Ä–∏–Ω–∞ –ø–æ –∞–Ω–∏–º–µ</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      min-height: 100vh;
      font-family: Arial, sans-serif;
      background-color: #f0f0f0;
      overflow-y: auto;
    }
    .quiz-container, .result-container, .leaderboard-container {
      background: white;
      padding: 15px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      max-width: 95%;
      width: 100%;
      box-sizing: border-box;
      margin: 10px auto;
      text-align: center;
    }
    .question {
      font-size: 1.1em;
      margin-bottom: 15px;
      word-wrap: break-word;
    }
    .options {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    .option {
      padding: 10px;
      background: #e0e0e0;
      border-radius: 5px;
      cursor: pointer;
      transition: background 0.3s;
      word-wrap: break-word;
    }
    .option:hover {
      background: #d0d0d0;
    }
    .result {
      margin-top: 15px;
      font-weight: bold;
    }
    button {
      margin-top: 15px;
      padding: 10px 20px;
      background: #1e90ff;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    button:hover {
      background: #1c86ee;
    }
    #posterCanvas {
      max-width: 100%;
      height: auto;
      display: none;
      margin: 10px auto;
    }
    .avatar {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      margin: 10px auto;
    }
    @media (max-width: 600px) {
      .quiz-container, .result-container, .leaderboard-container {
        padding: 10px;
        margin: 5px;
      }
      .question {
        font-size: 0.9em;
      }
      .option, button {
        font-size: 0.85em;
        padding: 8px;
      }
      .avatar {
        width: 60px;
        height: 60px;
      }
    }
  </style>
</head>
<body>
  <div class="quiz-container" id="quizContainer">
    <div class="question" id="question"></div>
    <div class="options" id="options"></div>
    <div class="result" id="result"></div>
    <button id="nextBtn" style="display: none;">–°–ª–µ–¥—É—é—â–∏–π</button>
    <button id="resetBtn" style="display: none;">–°–±—Ä–æ—Å–∏—Ç—å</button>
  </div>

  <div class="result-container" id="resultContainer" style="display: none;">
    <h2>üéâ –ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞!</h2>
    <p>–¢—ã –Ω–∞–±—Ä–∞–ª <span id="finalScore"></span> –æ—á–∫–æ–≤.</p>
    <button id="sendResultBtn">–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç</button>
    <button id="generatePosterBtn">–ü–æ–ª—É—á–∏—Ç—å –ø–æ—Å—Ç–µ—Ä</button>
    <canvas id="posterCanvas"></canvas>
  </div>

  <div class="leaderboard-container" id="leaderboardContainer" style="display: none;">
    <h2>üèÜ –õ–∏–¥–µ—Ä—ã</h2>
    <div id="leaderboard">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
  </div>

  <script>
    const questions = [
      {
        question: "–ö–∞–∫ –∑–æ–≤—É—Ç –≥–ª–∞–≤–Ω–æ–≥–æ –≥–µ—Ä–æ—è –∞–Ω–∏–º–µ '–ù–∞—Ä—É—Ç–æ'?",
        options: ["–°–∞—Å–∫–µ –£—á–∏—Ö–∞", "–ù–∞—Ä—É—Ç–æ –£–∑—É–º–∞–∫–∏", "–ö–∞–∫–∞—à–∏ –•–∞—Ç–∞–∫–µ", "–°–∞–∫—É—Ä–∞ –•–∞—Ä—É–Ω–æ"],
        correct: 1
      },
      {
        question: "–í –∫–∞–∫–æ–º –∞–Ω–∏–º–µ —Ñ–∏–≥—É—Ä–∏—Ä—É–µ—Ç –¢–µ—Ç—Ä–∞–¥—å –°–º–µ—Ä—Ç–∏?",
        options: ["–¢–µ—Ç—Ä–∞–¥—å –°–º–µ—Ä—Ç–∏", "–ê—Ç–∞–∫–∞ —Ç–∏—Ç–∞–Ω–æ–≤", "–°—Ç–∞–ª—å–Ω–æ–π –∞–ª—Ö–∏–º–∏–∫", "–í–∞–Ω –ü–∏—Å"],
        correct: 0
      },
      {
        question: "–ö—Ç–æ —è–≤–ª—è–µ—Ç—Å—è –∫–∞–ø–∏—Ç–∞–Ω–æ–º –∫–æ–º–∞–Ω–¥—ã –ö–∞—Ä–∞—Å—É–Ω–æ –≤ '–í–æ–ª–µ–π–±–æ–ª!!'?",
        options: ["–•–∏–Ω–∞—Ç–∞ –®–æ—ë", "–ö–∞–≥–µ—è–º–∞ –¢–æ–±–∏–æ", "–î–∞–π—á–∏ –°–∞–≤–∞–º—É—Ä–∞", "–ù–∏—à–∏–Ω–æ–π—è –Æ"],
        correct: 2
      }
    ];

    let currentQuestion = 0;
    let score = 0;
    let userAvatar = '';

    function loadQuestion() {
      const q = questions[currentQuestion];
      document.getElementById('question').innerText = q.question;
      const optionsDiv = document.getElementById('options');
      optionsDiv.innerHTML = '';
      q.options.forEach((option, index) => {
        const optionEl = document.createElement('div');
        optionEl.className = 'option';
        optionEl.innerText = option;
        optionEl.onclick = () => checkAnswer(index);
        optionsDiv.appendChild(optionEl);
      });
      document.getElementById('result').innerText = '';
      document.getElementById('nextBtn').style.display = 'none';
      document.getElementById('resetBtn').style.display = 'none';
    }

    function checkAnswer(selected) {
      const q = questions[currentQuestion];
      const resultDiv = document.getElementById('result');
      if (selected === q.correct) {
        resultDiv.innerText = '–ü—Ä–∞–≤–∏–ª—å–Ω–æ!';
        score++;
      } else {
        resultDiv.innerText = `–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ! –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: ${q.options[q.correct]}`;
      }
      document.getElementById('nextBtn').style.display = 'block';
      document.querySelectorAll('.option').forEach(opt => opt.style.pointerEvents = 'none');
    }

    document.getElementById('nextBtn').onclick = () => {
      currentQuestion++;
      if (currentQuestion < questions.length) {
        loadQuestion();
      } else {
        showResult();
      }
    };

    document.getElementById('resetBtn').onclick = () => {
      currentQuestion = 0;
      score = 0;
      document.getElementById('quizContainer').style.display = 'block';
      document.getElementById('resultContainer').style.display = 'none';
      document.getElementById('leaderboardContainer').style.display = 'none';
      loadQuestion();
    };

    function showResult() {
      document.getElementById('quizContainer').style.display = 'none';
      document.getElementById('resultContainer').style.display = 'block';
      document.getElementById('finalScore').innerText = score;
      document.getElementById('resetBtn').style.display = 'block';
    }

    document.getElementById('sendResultBtn').onclick = () => {
      if (window.Telegram?.WebApp) {
        window.Telegram.WebApp.sendData(JSON.stringify({ score, total: questions.length }));
      }
    };

    document.getElementById('generatePosterBtn').onclick = () => {
      generatePoster();
    };

    async function generatePoster() {
      const canvas = document.getElementById('posterCanvas');
      const ctx = canvas.getContext('2d');

      // –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–∞–∑–º–µ—Ä—ã –ø–æ—Å—Ç–µ—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 600x800 –ø–∏–∫—Å–µ–ª–µ–π)
      canvas.width = 600;
      canvas.height = 800;

      // –ó–∞–≥—Ä—É–∑–∫–∞ —à–∞–±–ª–æ–Ω–∞ –ø–æ—Å—Ç–µ—Ä–∞
      const templateImg = new Image();
      templateImg.crossOrigin = 'anonymous';
      templateImg.src = '/images/poster_template.png'; // –£–∫–∞–∂–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—É—Ç—å –∫ —à–∞–±–ª–æ–Ω—É

      templateImg.onload = async () => {
        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —à–∞–±–ª–æ–Ω–∞
        ctx.drawImage(templateImg, 0, 0, canvas.width, canvas.height);

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
        ctx.font = 'bold 30px Arial';
        ctx.fillStyle = '#000';
        ctx.textAlign = 'center';
        ctx.fillText(`–¢–≤–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: ${score} –∏–∑ ${questions.length}`, canvas.width / 2, 100);

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        const username = window.Telegram?.WebApp?.initDataUnsafe?.user?.username || '–ò–≥—Ä–æ–∫';
        ctx.font = '20px Arial';
        ctx.fillText(`@${username}`, canvas.width / 2, 150);

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∞–≤–∞—Ç–∞—Ä–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        if (window.Telegram?.WebApp?.initDataUnsafe?.user?.photo_url) {
          const avatarImg = new Image();
          avatarImg.crossOrigin = 'anonymous';
          avatarImg.src = window.Telegram.WebApp.initDataUnsafe.user.photo_url;
          avatarImg.onload = () => {
            ctx.beginPath();
            ctx.arc(100, 100, 50, 0, Math.PI * 2); // –ö—Ä—É–≥–ª—ã–π –∞–≤–∞—Ç–∞—Ä
            ctx.clip();
            ctx.drawImage(avatarImg, 50, 50, 100, 100);
            ctx.restore();
            finalizePoster();
          };
          avatarImg.onerror = () => {
            finalizePoster(); // –ï—Å–ª–∏ –∞–≤–∞—Ç–∞—Ä –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª—Å—è, –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –±–µ–∑ –Ω–µ–≥–æ
          };
        } else {
          finalizePoster();
        }
      };

      templateImg.onerror = () => {
        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —à–∞–±–ª–æ–Ω–∞ –ø–æ—Å—Ç–µ—Ä–∞');
        ctx.fillStyle = '#fff';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        ctx.fillStyle = '#000';
        ctx.font = 'bold 30px Arial';
        ctx.textAlign = 'center';
        ctx.fillText('–®–∞–±–ª–æ–Ω –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω', canvas.width / 2, canvas.height / 2);
        finalizePoster();
      };

      function finalizePoster() {
        // –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ—Å—Ç–µ—Ä
        document.getElementById('posterCanvas').style.display = 'block';
        // –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
        const downloadBtn = document.createElement('a');
        downloadBtn.href = canvas.toDataURL('image/png');
        downloadBtn.download = 'anime_quiz_poster.png';
        downloadBtn.innerText = '–°–∫–∞—á–∞—Ç—å –ø–æ—Å—Ç–µ—Ä';
        downloadBtn.style = 'display: block; margin: 10px auto; padding: 10px; background: #1e90ff; color: white; text-decoration: none; border-radius: 5px;';
        document.getElementById('resultContainer').appendChild(downloadBtn);
      }
    }

    window.onload = () => {
      if (window.Telegram?.WebApp) {
        window.Telegram.WebApp.ready();
        window.Telegram.WebApp.expand();
      }
      loadQuestion();
    };
  </script>
</body>
</html>
```
